

* Two approaches

** Blind with drainage

If you have a way to get rid of the exess water, which is difficult, the watering part is easy, you just flood periodically.

[[./img/watering3.jpeg]]

[[./img/watering4.jpeg]]

Moisture sensor(s) here are optional.

The way I get rid of the exess water is I detect it (link the sensor) and I pump it out of the house using a stronger pump (link the pump)

[[./img/watering2.jpeg]]


** Sensored control loop
I assume most people want this since it's difficult to link all the pots to pumps.

Each plant has it's own individual soil sensor and a simple controller that maintains a control loop of reading soil capcitive moisture data and triggering watering cycles.


* TODO Drainage

** TODO Plant Pot connection

Goal here was to design an outlet that doesn't require watertight seal since this is difficult and unreliable long term.

We use a bottom convex element to capture water flowing around the screw, though we expect the bulk of water to flow through it.

[[./img/potOutlet2.png]]

*** Soil filter
This is probably annoying to print for most people, We just want to prevent large chunks of soil from entering the outlet tube. A random rock, fine netting, a sponge etc is ok for this as well.

*** In-pot element
Gives you a screw on the other side. You can adjust a height of this according to your pot walls.

I sometimes print this in full size and break it off to size after fitting.
If your pot bottom is especially coarse you want to add sillicone where it connects to the pot to lower the flow, (you won't prevent it, especially long term)

*** Bottom convex element
Print this with a few walls (I use 4) to prevent random permiability.
You might want a random Z-seam alignment for the same reason as well.
Needs to be printed with supports.

Captures water that might leak from the sides of the screw. Provides a connection for a push-in fitting.

** TODO pump
...


* TODO Sensored control

[[./img/drawing1.png]]

Sensor reads moisture, valve tops up moisture, we avoid pot dripping or overwatering

** TODO Single localized channel

You might want to put a valve where the sensor is.

*** Upsides
You can have standalone device that's autonomous. External dependencies optional
Your computer can explode but this will work correctly as long as it has power and water

HASS used only as an UI to set tipping points for watering, data collection etc.

Instead of a valve you can connect a small pump, and pump water from a watering bottle close by

*** Downsides
A bit chunky I guess? Individual nodes a bit more complex, most of the system is pressurized

*** Implementation

- requires some sort of a way for a controller to use its low power/voltage output to
   trigger 12v/24v valve - TIP120


[[./img/single_node.jpg]]


** TODO Multi channel manifold

A centralized place with all the valves

[[./img/watering5.jpeg]]

*** Upsides
- Self contained, easy to maintain point that you can try and hide somewhere.
- It looks good on reddit

*** Implementation
- ULN2803 for 8 channel control instead of TIP120
- at least ESP32 for control due to more outputs


* TODO Watering Elements

Push in fittings I use are metric, if this is difficult in US you might need to remodel the screw parts:

- 12mm OD tube / M12 screw for outlets
- 6mm OD tube / M12 screw for inlets

Important note here. You want an O-ring, my fittings come with O-rings. otherwise you need to deal with sillicone/teflon for water tightness, this is much more convinient, without leaks even when screwing into 3d printed parts

[[./img/push_in_fitting.jpeg]]


** TODO Watering elements

[[./img/watering.png]]

I just leave it in a pot, would be nice to design some spikes that hold this thing in the soil, this is mostly for the vibes, simpler elements (gardena? (link it)) are fine here.

* TODO Panel
*** Requirements
- easy maitenance, easy to move stuff around, modular.
- easy to add new modules
- standardized inputs and outputs (so you can just add a fertilization module, sensor module, UV module etc)
- passthrough central bus for common connections (power, water_in, water_out, air)


*** Design

Module panel is actually IKEA skadis compatible, so you can just buy those. I cut mine on a CNC. If using cnc consider thin aluminium, since you are dealing with water.

[[./img/panel.png]]

form factor depends on your installation. one of the ideas was that you can overlay making maitenance and accesibility slightly worse

[[./img/panels.png]]

Each panel has inputs and outputs with standardized mounts for water/electricity/air/signals

Printable adapters for different sized connectors are possible.

[[./img/adapter.png]]


* TODO watering manifold module
...

* TODO In-line injector module (fertilization, sterilization etc)
This is optional and many ways to go about it.

#+begin_src dot :file ./img/injector.svg :results file graphics
digraph {
        rankdir=LR;
        bgcolor=white; fontname="monospace"; fontsize=10; fontcolor=black;
        node [shape=egg height="0.5" margin="0.1,0.05"  color="#00000099" style="solid" fontname="monospace"; fontsize=10; fontcolor=black]
        edge [color="black" fillcolor="white" style="solid"]

        subgraph cluster_water_flow {
                label="Main Flow"; style="dotted"
                edge [color="#2196F3" fillcolor="white" style="solid" weight=5]
                water_in -> flow_sensor -> water_out
        }

        subgraph {
                edge [color="#66dd66" fillcolor="white" style="solid" weight=2]
                fertilizer -> pump
                pump -> water_out
        }

        subgraph {
                edge [color="#FF9800" fillcolor="white" style="dashed" arrowhead="none" weight=0]
                controller -> flow_sensor, pump
        }

}
#+end_src

[[file:./img/injector.svg]]



Controller scales pump speed according to water flow.
If you have consistent pressure you can just calibrate the pump to work on a consistent speed instead of having sensored control.

** TODO EC calibration
We need to figure out how hard we want to run the pump depending on the detected flow speed.
You'll need a handheld EC meter, (need to describe this)

** TODO Different options
- Just fertilize manually into the pots every once in a while?

I use a flow sensor. The best sensor you can use here would be something that can actually measure whatever you are mixing into the line, since it takes into account inconsistent pumping speeds, can detect mixing issues etc.

- For fertilizer, you could measure electrical conductivity.
- For h2o2 (if sterilizing the system) you could measure ORP
